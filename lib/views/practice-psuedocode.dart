// fucntion that looks at the datatable, takes the value from position
// write all the code out fully and then you will be able to see whereabouts you can DRY refactor it